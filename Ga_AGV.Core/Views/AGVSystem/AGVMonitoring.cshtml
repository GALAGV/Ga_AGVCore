@{
    ViewBag.Title = "AGVMonitoring";
    Layout = "~/Views/Shared/_LayoutPage.cshtml";
    ViewBag.PageTitle = "AGV系统";
    ViewBag.PageColumn = "运行监控";
}
<link href="~/Scripts/AGVSystem/jquery-ui.min.css" rel="stylesheet" />
<script src="~/Scripts/AGVSystem/jquery-ui.min.js"></script>
<div>
    <style>
        .id {
            width: 504px;
            height: 504px;
            border: 2px solid #000000;
            overflow: hidden;
            color: yellow;
        }
    </style>
    <div style="width:200px;height:50px">
        <form id="reservation">
            <div id='slider'></div><p id="p_text" style="float:right">X1</p>
        </form>
    </div>

    <!--画板-->
    <div id="grid">
        <canvas id="canvas">您当前的浏览器版本不支持此功能</canvas>
    </div>

    <script type="text/javascript">

        var Wid = 1000; var Hei = 800;
        var ar = new Array();

        $(function () {
            $.ajax({
                url: '/api/AGVSystem/ShowPlace',
                type: "post",
                contentType: 'application/json',
                success: function (data) {
                    for (var i = 0; i < data.total; i++) {
                        ar.push(data.rows[i])
                    }
                    Show(Wid, Hei, ar, 1);
                    console.log(ar);
                }
            });

            //比例尺
            var select = $("#minbeds");
            var slider = $("#slider").slider({
                min: 1,
                max: 5,
                range: "min",
                slide: function (event, ui) {
                    Wid = 1000 * ui.value; Hei = 800 * ui.value;
                    $('#p_text').text("X" + ui.value);
                    Show(Wid, Hei, ar, ui.value);
                    console.log(Wid);
                }
            });
            //比例尺

            function Show(Wid, Hei, ar, coe) {
                $("#grid").css({ width: Wid, height: Hei, border: '2px solid #000000' })
                console.log(Wid + '----' + Hei);
                var canvas = document.getElementById('canvas');
                canvas.width = Wid;
                canvas.height = Hei;
                if (canvas.getContext) {
                    var ctx = canvas.getContext("2d"),
                        width = canvas.width,
                        height = canvas.height;
                    //点
                    for (var i = 0; i < ar.length; i++) {
                        ctx.beginPath();
                        ctx.arc(ar[i].qrX * coe, ar[i].qrY * coe, (Wid / 100), 0, 2 * Math.PI, false);
                        ctx.closePath(); //关闭路径
                        if (ar[i].qrStatus == 1) {
                            ctx.fillStyle = "green";
                        } else {
                            ctx.fillStyle = "red";
                        }
                        ctx.fill();//以填充方式绘制圆
                    }
                    ////横线
                    ctx.lineWidth = (Wid / 100);//粗细
                    ctx.strokeStyle = "red";
                    ctx.beginPath();
                    ctx.moveTo(ar[2].qrX * coe, ar[2].qrY * coe);
                    ctx.lineTo(ar[4].qrX * coe, ar[4].qrY * coe);
                    ctx.stroke();
                    ////纵线
                    ctx.strokeStyle = "red";
                    ctx.beginPath();
                    ctx.moveTo(ar[4].qrX * coe, ar[4].qrY * coe);
                    ctx.lineTo(ar[18].qrX * coe, ar[18].qrY * coe);
                    ctx.stroke();

                }
            }

        })
    </script>
</div>