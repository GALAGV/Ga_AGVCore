@{
    ViewBag.Title = "AGVManagement";
    Layout = "~/Views/Shared/_LayoutPage.cshtml";
    ViewBag.PageTitle = "AGV系统";
    ViewBag.PageColumn = "AGV管理";
}
<script src="~/Scripts/Equipment/AGVManagement.js"></script>
<div class="count-panel" style="width:100%;min-width:500px;margin:0px auto;">
    <div class="x_title">
        <div class="clearfix">
            <div class="panel-body" style="padding:0px;">
                <form id="formSearch" class="form-horizontal">
                    <div class="panel panel-default">
                        <div class="panel-heading " id="pal-text"><span class="glyphicon glyphicon-filter" aria-hidden="true"></span>&nbsp;查询条件<span style="float:right;"><a href="javascript:;" class="Inquire-text" id="btn_query"><span class="glyphicon glyphicon-search" aria-hidden="true"></span>&nbsp;查询</a></span></div>
                        <div class="panel-body">
                            <div class="form-group">
                                <label class="control-label col-sm-1" for="txt_search_rolename">AGV编号</label>
                                <div class="col-sm-3">
                                    <input type="text" id="AGVNumber" class="form-control">
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
                <div class="panel panel-default">
                    <div class="panel-heading" id="pal-text"><span class="glyphicon glyphicon-cog" aria-hidden="true"></span>&nbsp;数据列表</div>
                    <div class="panel-body" style="padding:10px;">
                        <div id="toolbar" class="btn-group">
                            <button id="btn_add" type="button" class="btn btn-default">
                                <span class="glyphicon glyphicon-plus" aria-hidden="true" style="font-size:10px;"></span>&nbsp;新增
                            </button>
                            <button id="btn_edit" type="button" class="btn btn-default">
                                <span class="glyphicon glyphicon-pencil" aria-hidden="true" style="font-size:10px;"></span>&nbsp;修改
                            </button>
                            <button id="btn_delete" type="button" class="btn btn-default">
                                <span class="glyphicon glyphicon-remove" aria-hidden="true" style="font-size:10px;"></span>&nbsp;删除
                            </button>
                        </div>
                        <table id="tb_report"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<form>
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">新增</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="txt_rolename">AGV编号</label>
                        <input type="text" name="agvNum" class="form-control" id="agvNum" placeholder="AGV编号">
                        <input id="agvId" class="form-control" type="hidden" />
                    </div>
                    <div class="form-group">
                        <label for="txt_rolename">序列号</label>
                        <input type="text" name="agvSerialNum" class="form-control" id="agvSerialNum" placeholder="AGV序列号">
                    </div>
                    <div class="form-group">
                        <label for="txt_defaulturl">IP地址</label>
                        <input type="text" name="agvIp" class="form-control" id="agvIp" placeholder="IP地址">
                    </div>
                    <div class="form-group">
                        <label for="txt_defaulturl_Web">端口号</label>
                        <input type="text" name="agvPort" class="form-control" id="agvPort" placeholder="端口号">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>关闭</button>
                    <button type="button" id="btn_submit" class="btn btn-primary"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span>保存</button>
                </div>
            </div>
        </div>
    </div>
</form>
<style>
    .Control-li li {
        width: 24%;
        height: 50px;
        text-align: center;
        line-height: 50px;
        display: inline-block;
    }

    .dropdown-menu {
        position: absolute;
        top: 103%;
        left: 0;
        z-index: 1000;
        display: none;
        float: left;
        list-style: none;
        text-shadow: none;
        max-height: 180px;
        margin: 0px;
        font-size: 14px;
        font-family: "Segoe UI",Helvetica, Arial, sans-serif;
        border: 1px solid #ddd;
    }

    .form-control {
        display: block;
        width: 100%;
        height: 34px;
        padding: 6px 12px;
        font-size: 14px;
        line-height: 1.42857143;
        color: #555;
        background-color: #fff;
        background-image: none;
        border: 1px solid #ccc;
        border-radius: 4px;
    }
</style>
<div class="modal  fade bs-example-modal-lg" id="AGVControl" tabindex="-1" role="dialog" aria-labelledby="AGVtitle">
    <div class="modal-dialog modal-lg" style="width:95%;min-width:980px; max-width:1400px" role="document">
        <div class="modal-content">
            <div class="modal-header" style="padding:10px;">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="AGVtitle"></h4>
            </div>
            <div class="modal-body" style="background: #EDEDED;padding:6px 10px;overflow:hidden;">
                <div>
                    <div style="display:block;float:left;width:49.8%;">
                        <div class="count-panel" style="width:100%;margin:0px auto;height:438px">
                            <div class="x_title">
                                <h2 style="font-size:18px;">基本信息</h2>
                                <div class="clearfix"></div>
                            </div>
                            <div class="clearfix">
                                <div style="width:100%;">
                                    <ul class="Control-li" style="display:block;height:50px;">
                                        <li style="background-color:#1ABC9C;color:white;font-size:18px;border-radius:2%">AGV编号</li>
                                        <li style="font-size:18px;font-weight:bold;background: #EDEDED;" id="agvNu">0号</li>
                                        <li style="background-color:#1ABC9C;color:white;font-size:18px;border-radius:2%">固件版本</li>
                                        <li style="font-size:18px;font-weight:bold;background: #EDEDED;">V1.0.5</li>
                                    </ul>
                                    <ul class="Control-li" style="display:block;height:50px;margin-top:15px;">
                                        <li style="background-color:#1ABC9C;color:white;font-size:18px;border-radius:2%">二维码</li>
                                        <li style="font-size:18px;font-weight:bold;background: #EDEDED;">00015</li>
                                        <li style="background-color:#1ABC9C;color:white;font-size:18px;border-radius:2%">状态</li>
                                        <li style="font-size:18px;font-weight:bold;background: #EDEDED;color:#139656">在线</li>
                                    </ul>
                                    <ul class="Control-li" style="display:block;height:50px;margin-top:15px;">
                                        <li style="background-color:#1ABC9C;color:white;font-size:18px;border-radius:2%">PBS</li>
                                        <li style="font-size:18px;font-weight:bold;background: #EDEDED;">区域6</li>
                                        <li style="background-color:#1ABC9C;color:white;font-size:18px;border-radius:2%">云台</li>
                                        <li style="font-size:18px;font-weight:bold;background: #EDEDED;">上升</li>
                                    </ul>
                                    <ul class="Control-li" style="display:block;height:50px;margin-top:15px;">
                                        <li style="background-color:#1ABC9C;color:white;font-size:18px;border-radius:2%">报警信息</li>
                                        <li style="font-size:18px;font-weight:bold;background: #EDEDED;width:74%;color:#139656">正常</li>
                                    </ul>
                                </div>
                                <div style="margin-top:30px;">
                                    <ul class="Control-li" style="display:block;height:50px;">
                                        <li style="padding:8px;padding-left:0px;"><button type="button" class="btn btn-danger" style="width:100%;height:45px;" onclick="Scram()">急停</button></li>
                                        <li style="padding:8px"><button type="button" class="btn btn-primary" style="width:100%;height:45px;" onclick="ManualSelfMotion()">手动</button></li>
                                        <li style="padding:8px"><button type="button" class="btn btn-primary" style="width:100%;height:45px;" onclick="Restoration()">复位</button></li>
                                        <li style="padding:8px;padding-right:0px;"><button type="button" class="btn btn-primary" style="width:100%;height:45px;">固件升级</button></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="count-panel" style="width:100%;margin:0px auto;height:262px;margin-top:4px;">
                            <div class="x_title">
                                <h2 style="font-size:18px;">AGV状态</h2>
                                <div class="clearfix"></div>
                            </div>
                            <div class="clearfix">
                                <ul>
                                    <li style="width:50%;height:200px;float:left" id="container-speed"></li>
                                    <li style="width:50%;height:200px;float:left" id="container-rpm"></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div style="display:block;float:right;width:49.8%">
                        <div class="count-panel" style="width:100%;margin:0px auto;height:704px">
                            <div class="x_title">
                                <h2 style="font-size:18px;">AGV控制</h2>
                                <div class="clearfix"></div>
                            </div>
                            <div class="clearfix">
                                <div style="height:50%;overflow:hidden;">
                                    <div style="width:50%;float:left;position:relative;max-width:290px;">
                                        <img src="~/image/agv-on.gif" style="max-width:290px;width:100%;height:250px; " />
                                        <span style="position:absolute;top:40px;left:0%;text-align:center;width:100%;"><span style="font-size:20px;color:white;font-weight:bold;font-family:'微软雅黑';padding:0px 8px;border:1px solid white;border-radius:5%" id="agvNums"></span></span>
                                        <span style="position:absolute;top:190px;left:0%;text-align:center;width:100%;"><span style="font-size:20px;color:white;font-weight:bold;font-family:'微软雅黑';">在线</span></span>
                                    </div>
                                    <div style="float:right;width:49%;height:250px;">
                                        <ul style="margin-top:60px;">
                                            <li style="text-align:center"><button type="button" onclick="agvstarts()" class="btn btn-primary" style="width:100%;height:45px;max-width:250px;" >启动</button></li>
                                            <li style="margin-top:50px;text-align:center"><button type="button" class="btn btn-primary" style="width:100%;height:45px;max-width:250px;" onclick="agvstop()">停止</button></li>
                                        </ul>
                                    </div>
                                </div>
                                <div style="width:100%;margin-top:40px;">
                                    <ul>
                                        <li style="height:32px;">
                                            <div style="width:80%;float:left;">
                                                <div class="form-group">
                                                    <div class="input-group">
                                                        <span class="input-group-addon" id="basic-addon2">PBS：</span>
                                                        <select id="PBS" class="selectpicker show-tick form-control" data-live-search="false" aria-describedby="basic-addon2">
                                                            <option value="0">区域0</option>
                                                            <option value="1">区域1</option>
                                                            <option value="2">区域2</option>
                                                            <option value="3">区域3</option>
                                                            <option value="4">区域4</option>
                                                            <option value="5">区域5</option>
                                                            <option value="6">区域6</option>
                                                            <option value="7">区域7</option>
                                                            <option value="8">区域8</option>
                                                            <option value="9">区域9</option>
                                                            <option value="10">区域10</option>
                                                            <option value="11">区域11</option>
                                                            <option value="12">区域12</option>
                                                            <option value="13">区域13</option>
                                                            <option value="14">区域14</option>
                                                            <option value="15">区域15</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="width:20%;float:right;padding:0px 9px;">
                                                <button type="button" class="btn btn-primary" style="width:100%;height:32px;max-width:250px;" onclick="UpdatePBS()">修改</button>
                                            </div>
                                        </li>
                                        <li style="margin-top:50px;text-align:center;">
                                            <button type="button" class="btn btn-primary" style="width:100%;height:45px;max-width:250px;"  onclick="DeckRise()">云台上升</button>
                                            <button type="button" class="btn btn-primary" style="width:100%;height:45px;max-width:250px;" onclick="DeckDecline()">云台下降</button>
                                        </li>
                                        <li style="margin-top:50px;text-align:center">
                                            <button type="button" class="btn btn-primary" style="width:100%;height:45px;max-width:250px;" onclick="LeftTurn()">左转</button>
                                            <button type="button" class="btn btn-primary" style="width:100%;height:45px;max-width:250px;" onclick="rightTurn()">右转</button>
                                        </li>
                                        <li style="margin-top:50px;">
                                            <div style="width:80%;float:left;">
                                                <div class="form-group">
                                                    <div class="input-group">
                                                        <span class="input-group-addon" id="basic-addon2">速度：</span>
                                                        <select class="selectpicker show-tick form-control" aria-describedby="basic-addon2" data-live-search="false" id="speed">
                                                            <option value="1">0：5</option>
                                                            <option value="2">1：0</option>
                                                            <option value="3">2：15</option>
                                                            <option value="4">3：20</option>
                                                            <option value="5">4：25</option>
                                                            <option value="6">5：30</option>
                                                            <option value="7">6：35</option>
                                                            <option value="8">7：40</option>
                                                            <option value="9">8：50</option>
                                                            <option value="10">9：30</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="width:20%;float:right;padding:0px 9px;">
                                                <button type="button" class="btn btn-primary" style="width:100%;height:32px;max-width:250px;" onclick="UpdateSpeed()">修改</button>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>

    // 公共配置
    Highcharts.setOptions({
        chart: {
            type: 'solidgauge'
        },
        title: null,
        pane: {
            center: ['50%', '85%'],
            size: '140%',
            startAngle: -90,
            endAngle: 90,
            background: {
                backgroundColor: (Highcharts.theme && Highcharts.theme.background2) || '#EEE',
                innerRadius: '60%',
                outerRadius: '100%',
                shape: 'arc'
            }
        },
        tooltip: {
            enabled: false
        },
        yAxis: {
            stops: [
                [0.1, '#55BF3B'], // green
                [0.5, '#DDDF0D'], // yellow
                [0.9, '#DF5353'] // red
            ],
            lineWidth: 0,
            minorTickInterval: null,
            tickPixelInterval: 400,
            tickWidth: 0,
            title: {
                y: -70
            },
            labels: {
                y: 16
            }
        },
        plotOptions: {
            solidgauge: {
                dataLabels: {
                    y: 5,
                    borderWidth: 0,
                    useHTML: true
                }
            }
        }
    });
    // 速度仪表
    var chart1 = Highcharts.chart('container-speed', {
        yAxis: {
            min: 0,
            max: 200,
            title: {
                text: '速度'
            }
        },
        credits: {
            enabled: false
        },
        series: [{
            name: '速度',
            data: [80],
            dataLabels: {
                format: '<div style="text-align:center"><span style="font-size:25px;color:' +
                    ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y}</span><br/>' +
                    '<span style="font-size:12px;color:silver">m/min</span></div>'
            },
            tooltip: {
                valueSuffix: ' km/h'
            }
        }]
    });
    // 电量仪表
    var chart2 = Highcharts.chart('container-rpm', {
        yAxis: {
            min: 0,
            max: 100,
            title: {
                text: '电压'
            }
        },
        series: [{
            name: '电压',
            data: [1],
            dataLabels: {
                format: '<div style="text-align:center"><span style="font-size:25px;color:' +
                    ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y:.1f}</span><br/>' +
                    '<span style="font-size:12px;color:silver">v</span></div>'
            },
            tooltip: {
                valueSuffix: ' revolutions/min'
            }
        }]
    });
    // 定时刷新数据
    setInterval(function () {
        var point,
            newVal,
            inc;
        if (chart1) {
            point = chart1.series[0].points[0];
            inc = Math.round((Math.random() - 0.5) * 100);
            newVal = point.y + inc;
            if (newVal < 0 || newVal > 200) {
                newVal = point.y - inc;
            }
            point.update(newVal);
        }
        if (chart2) {
            point = chart2.series[0].points[0];
            inc = Math.random() - 0.5;
            newVal = point.y + inc;
            if (newVal < 0 || newVal > 5) {
                newVal = point.y - inc;
            }
            point.update(newVal);
        }
    }, 2000);
</script>